# Claude AI Passage Generation

## Overview
The app now uses **Claude AI** to dynamically generate unique reading passages instead of using hardcoded text. Every time a user selects a difficulty, Claude generates a fresh, contextually appropriate passage.

---

## ğŸŒŸ What Changed

### Before:
- âŒ 24 hardcoded passages in `passages.json`
- âŒ Users could memorize passages
- âŒ Limited content variety

### Now:
- âœ… **Infinite unique passages** generated by Claude AI
- âœ… Never repeating content
- âœ… Falls back to local passages if API fails
- âœ… Loading indicator while generating

---

## ğŸ”§ Setup Required

### 1. Get Claude API Key

1. Go to: https://console.anthropic.com/
2. Sign up for an account
3. Go to **API Keys** section
4. Click **Create Key**
5. Copy your API key

### 2. Add to config.js

Open `config.js` and add your Claude API key:

```javascript
export const CLAUDE_API_KEY = 'sk-ant-api03-xxxxx...';
```

**Note**: Don't commit `config.js` (it's already gitignored)

---

## ğŸ¯ How It Works

### User Flow:
```
User Selects Difficulty
    â†“
App calls Claude API
    â†“
Claude generates passage (1-2 seconds)
    â†“
User sees "âœ¨ Generating your unique passage with AI..."
    â†“
Passage appears
    â†“
User practices reading
```

### API Call Details:
- **Model**: Claude 3.5 Sonnet
- **Temperature**: 1.0 (creative/varied)
- **Max Tokens**: 300
- **Cost**: ~$0.001-0.003 per passage

### Prompt Engineering:
The system sends detailed prompts to Claude specifying:
- Difficulty level (easy/medium/hard)
- Target age group
- Word count
- Reading time
- Vocabulary complexity
- Sentence structure
- Topic suggestions

---

## ğŸ“Š Difficulty Specifications

### Easy (10 seconds)
- **Words**: 25-35
- **Age**: 8-10 years
- **Vocabulary**: Very simple and basic
- **Examples**: cat, dog, sun, play, happy

### Medium (20 seconds)
- **Words**: 50-70
- **Age**: 11-13 years
- **Vocabulary**: Moderate complexity
- **Examples**: ancient, mysterious, discovered, adventure

### Hard (30 seconds)
- **Words**: 80-100
- **Age**: 13-16 years
- **Vocabulary**: Advanced and sophisticated
- **Examples**: phenomenon, unprecedented, meticulously

---

## ğŸ”„ Fallback System

If Claude API fails (no API key, network error, rate limit):
1. App catches error
2. Logs warning to console
3. **Falls back to local passages** from `passages.json`
4. User still gets content (no interruption)

```javascript
try {
  // Generate with Claude AI
  passage = await generatePassage(difficulty);
} catch (error) {
  // Fall back to local passages
  passage = passagesData[difficulty][randomIndex];
}
```

---

## ğŸ“ New Files

### `src/services/passageGenerationService.js`
Contains the Claude API integration:
- `generatePassage(difficulty)` - Generate single passage
- `generateMultiplePassages(difficulty, count)` - Generate multiple (for preloading)

### `scripts/uploadPassagesToFirebase.js`
Script to upload local passages to Firebase (for future use):
```bash
node scripts/uploadPassagesToFirebase.js
```

**Note**: Requires Firebase permissions update (see below)

---

## ğŸ” Firebase Setup (Optional)

To upload passages to Firebase as backup:

### Update Firebase Rules:
```json
{
  "rules": {
    "users": {
      "$uid": {
        ".read": "$uid === auth.uid",
        ".write": "$uid === auth.uid"
      }
    },
    "passages": {
      ".read": "auth != null",
      ".write": "auth != null"
    }
  }
}
```

### Upload Passages:
```bash
node scripts/uploadPassagesToFirebase.js
```

This creates:
```
/passages
  /easy (8 passages)
  /medium (8 passages)
  /hard (8 passages)
```

---

## ğŸ’° Cost Breakdown

### Claude API Pricing:
- **Model**: Claude 3.5 Sonnet
- **Input**: ~$3 per million tokens
- **Output**: ~$15 per million tokens

### Per Passage Cost:
- Input: ~200 tokens = $0.0006
- Output: ~100 tokens = $0.0015
- **Total**: ~$0.002 per passage

### Usage Estimate:
- 100 passages = $0.20
- 1,000 passages = $2.00
- 10,000 passages = $20.00

**Very affordable for a hackathon/MVP!**

---

## ğŸ¨ UI Changes

### New Loading State:
When generating passage:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ ActivityIndicator   â”‚
â”‚                         â”‚
â”‚  âœ¨ Generating your     â”‚
â”‚  unique passage with    â”‚
â”‚  AI...                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Console Logs:
```
Generating easy passage with Claude AI...
âœ… Generated easy passage (32 words)
```

Or on fallback:
```
Failed to generate passage with Claude AI: [error]
Falling back to local passages...
âœ… Loaded passage from local database
```

---

## ğŸ§ª Testing

### Test with API Key:
1. Add Claude API key to `config.js`
2. Select any difficulty in Learn Mode
3. See loading indicator (1-2 seconds)
4. Unique passage appears
5. Try again - different passage each time!

### Test Fallback:
1. Remove/invalidate API key in `config.js`
2. Select difficulty
3. See error in console
4. Local passage loads automatically
5. App still works!

---

## ğŸš€ Benefits

1. **Infinite Content**: Never run out of passages
2. **Always Fresh**: Users can't memorize content
3. **Scalable**: Works for any number of users
4. **Contextual**: Can add themes, topics, personalization later
5. **Professional**: Shows advanced AI integration

---

## ğŸ”® Future Enhancements

### Personalization:
- Generate passages about user's interests
- Adjust to user's reading level dynamically
- Create themed passage sets

### Caching:
- Pre-generate passages in background
- Store in local cache for offline use
- Reduce API calls

### Analytics:
- Track which passages users like
- Analyze difficulty accuracy
- A/B test passage styles

---

## ğŸ“ Summary

**Before**: 24 hardcoded passages
**Now**: â™¾ï¸ AI-generated passages

**Setup**:
1. Get Claude API key from console.anthropic.com
2. Add to `config.js`
3. Done!

**Cost**: ~$0.002 per passage (very affordable)

**Fallback**: Local passages if API fails

**Result**: Professional, scalable, never-repeating content! ğŸ‰

---

*Implemented: 2026-01-31*
*Feature: Claude AI Passage Generation*
